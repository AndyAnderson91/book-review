{%  extends 'br/base.html' %}
{% block content %}
<h1>{{book.title}}</h1>
<p>Author{{ book.authors.all|length|pluralize }}:
    {% for author in book.authors.all %}
    <a href="{% url 'br:search' %}?q={{author}}&category=author">{{author}}</a>{% if not forloop.last %},{% endif %}
    {% endfor %}
</p>
<p>Genre{{ book.genres.all|length|pluralize }}:
    {% for genre in book.genres.all %}
    <a href="{% url 'br:search' %}?q={{genre}}&category=genre">{{genre|lower}}</a>{% if not forloop.last %},{% endif %}
    {% endfor %}
</p>
{% if book.is_published %}
<p>Published: <a href="{% url 'br:search' %}?q={{book.pub_date.year}}&category=year">{{book.pub_date.year}}</a></p>
{% else %}
<p>Expected at {{book.pub_date|date:'F'}} {{book.pub_date.day}}, <a href="{% url 'br:search' %}?q={{book.pub_date.year}}&category=year">{{book.pub_date.year}}</a></p>
{% endif %}
<p>Original language: {{book.language}}</p>
<p>{{book.description}}</p>


<a name="reviews"></a>
{% if book.is_published %}

{% if reviews %}
<h2>Reviews({{reviews|length}}):</h2>
{% else %}
<h2>No reviews yet</h2>
{% endif %}

{% if reviews.0.owner != request.user %}
<p>
    <a href="{% url 'br:add_review' book.id book.slug %}">Write review</a>
</p>
{% endif %}

{% for review in page_obj %}
{% include 'br/review_bar.html' %}
{% endfor %}

{% else %}

<h2>Reviews can be written as soon as the book is published</h2>

{% endif %}

{% include 'br/pagination.html' %}

{% endblock content %}